<Window
    x:Class="RdpLauncher.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:RdpLauncher"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Title Bar -->
        <Grid x:Name="AppTitleBar" Grid.Row="0" Background="Transparent">
            <TextBlock Text="RDP Launcher"
                       Style="{StaticResource CaptionTextBlockStyle}"
                       VerticalAlignment="Center"
                       Margin="16,0,0,0"/>
        </Grid>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="24" Spacing="16" MaxWidth="600">
                
                <TextBlock Text="RDP Connection Settings"
                           Style="{StaticResource TitleTextBlockStyle}"
                           Margin="0,8,0,16"/>

                <!-- Server Address -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Server Address" 
                               Style="{StaticResource BodyStrongTextBlockStyle}"/>
                    <TextBox x:Name="ServerAddressTextBox"
                             PlaceholderText="server.domain.com"
                             TextChanged="ServerAddressTextBox_TextChanged"/>
                </StackPanel>

                <!-- Resolution Settings -->
                <TextBlock Text="Resolution"
                           Style="{StaticResource SubtitleTextBlockStyle}"
                           Margin="0,16,0,8"/>
                
                <TextBlock Text="Note: When using preset positions (Left/Center/Right), the resolution is fixed at 2532×2012. Custom resolution is available if you modify the Width/Height values below."
                           Style="{StaticResource CaptionTextBlockStyle}"
                           TextWrapping="Wrap"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                           Margin="0,0,0,8"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Spacing="8">
                        <TextBlock Text="Width" 
                                   Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <NumberBox x:Name="WidthNumberBox"
                                   Value="2532"
                                   Minimum="800"
                                   Maximum="7680"
                                   SpinButtonPlacementMode="Inline"
                                   ValueChanged="ResolutionNumberBox_ValueChanged"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Spacing="8">
                        <TextBlock Text="Height" 
                                   Style="{StaticResource BodyStrongTextBlockStyle}"/>
                        <NumberBox x:Name="HeightNumberBox"
                                   Value="2012"
                                   Minimum="600"
                                   Maximum="4320"
                                   SpinButtonPlacementMode="Inline"
                                   ValueChanged="ResolutionNumberBox_ValueChanged"/>
                    </StackPanel>
                </Grid>

                <!-- Common Resolutions -->
                <StackPanel Spacing="8">
                    <TextBlock Text="Quick Presets" 
                               Style="{StaticResource BodyStrongTextBlockStyle}"/>
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <Button Content="2532×2012 (Default)" Click="SetResolution_2532x2012"/>
                        <Button Content="1920×1080" Click="SetResolution_1920x1080"/>
                        <Button Content="2560×1440" Click="SetResolution_2560x1440"/>
                    </StackPanel>
                </StackPanel>

                <!-- Window Position -->
                <TextBlock Text="Window Position"
                           Style="{StaticResource SubtitleTextBlockStyle}"
                           Margin="0,16,0,8"/>

                <StackPanel Spacing="8">
                    <TextBlock Text="Choose where to place the RDP window on your ultrawide monitor" 
                               Style="{StaticResource BodyStrongTextBlockStyle}"/>
                    <ComboBox x:Name="MonitorComboBox"
                              HorizontalAlignment="Stretch"
                              SelectionChanged="MonitorComboBox_SelectionChanged">
                        <ComboBoxItem Content="Left (2532×2012)" Tag="0,25,2532,2037" IsSelected="True"/>
                        <ComboBoxItem Content="Center (2532×2012)" Tag="1294,25,3826,2037"/>
                        <ComboBoxItem Content="Right (2532×2012)" Tag="2560,25,5092,2037"/>
                    </ComboBox>
                </StackPanel>

                <!-- Launch Button -->
                <Button x:Name="LaunchButton"
                        Content="Launch RDP Connection"
                        Style="{StaticResource AccentButtonStyle}"
                        HorizontalAlignment="Stretch"
                        Padding="16,12"
                        Margin="0,24,0,0"
                        Click="LaunchButton_Click"
                        IsEnabled="False"/>

                <!-- Status Message -->
                <InfoBar x:Name="StatusInfoBar"
                         IsOpen="False"
                         Margin="0,8,0,0"/>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
